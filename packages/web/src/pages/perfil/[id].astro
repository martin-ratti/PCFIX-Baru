---
export const prerender = false;

import Layout from '../../layouts/Layout.astro';
import Header from '../../components/layout/Header.astro';
import Footer from '../../components/layout/Footer.astro';
import EditProfileForm from '../../components/profile/EditProfileForm';
// CAMBIO CRÍTICO: Usar UserGuard, no AdminGuard
import UserGuard from '../../components/auth/UserGuard.tsx'; 

const { id } = Astro.params;

if (!id) {
  return new Response(null, {
    status: 404,
    statusText: 'Not Found'
  });
}
---

<Layout title={`PCFIX | Perfil ${id}`}>
  <Header />
  
  <main class="container mx-auto px-6 py-12 bg-light min-h-screen">
    <div class="mb-8">
        <h1 class="text-3xl font-black text-primary">Mi Perfil</h1>
        <p class="text-muted">Administra tu información personal y cuenta.</p>
    </div>
    
    {/* Protegemos con UserGuard para que entren clientes y admins */}
    <UserGuard client:only="react">
      <EditProfileForm userId={id} client:load />
    </UserGuard>

  </main>

  <Footer />
</Layout>